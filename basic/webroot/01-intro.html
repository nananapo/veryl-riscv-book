<!doctype html>
<html lang="ja">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title>Intro | Verylで作るRISC-V CPU</title>
    <link rel="stylesheet" type="text/css" href="css/normalize.css" />
    <link rel="stylesheet" type="text/css" href="css/webstyle.css" />
    <link rel="next" title="環境構築" href="02-setup.html">
    <link rel="prev" title="まえがき / はじめに" href="00-preface.html">
    <meta name="generator" content="Re:VIEW Starter">
  </head>
  <body>
    <div class="page-outer">
      <div class="side-content">
                <a class="nav-title" href="index.html">Verylで作るRISC-V CPU</a>
<ul class="toc toc-1">
    <li class="toc-chapter"><a href="./00-preface.html">まえがき / はじめに</a></li>
    <li class="toc-chapter"><a href="./01-intro.html">Intro</a>
      <ul class="toc toc-2">
        <li class="toc-section"><a href="#h">RISC-V</a></li>
        <li class="toc-section"><a href="#h">使用する言語</a></li>
        <li class="toc-section"><a href="#h">本書の構成</a></li>
      </ul>
    </li>
<li class="toc-part">第I部 RV32I/RV64Iの実装
  <ul class="toc toc-2">
    <li class="toc-chapter"><a href="./02-setup.html">1 環境構築</a></li>
    <li class="toc-chapter"><a href="./03-veryl.html">2 ハードウェア記述言語 Veryl</a></li>
    <li class="toc-chapter"><a href="./04-impl-rv32i.html">3 RV32Iの実装</a></li>
    <li class="toc-chapter"><a href="./04a-zicsr.html">4 Zicsr拡張の実装</a></li>
    <li class="toc-chapter"><a href="./04b-riscvtests.html">5 riscv-testsによるテスト</a></li>
    <li class="toc-chapter"><a href="./05-impl-rv64i.html">6 RV64Iの実装</a></li>
    <li class="toc-chapter"><a href="./05a-pipeline.html">7 CPUのパイプライン処理化</a></li>
    <li class="toc-chapter"><a href="./05b-synth.html">8 CPUを合成する</a></li>
  </ul>
</li>
    <li class="toc-chapter"><a href="./99-postface.html">あとがき / おわりに</a></li>
    <li class="toc-chapter"><a href="./bib.html">参考文献</a></li>
</ul>
      </div>
      <div class="page-inner">
        <header class="page-header">
        </header>
        <main class="page-main">
<h1 class="none center"><a id="h"></a><br/>Intro</h1>
<p>こんにちは! あなたはCPUを作成したことがありますか!作成したことがあってもなくても大歓迎、この本はCPU自作の面白さVerylを世に広めるために執筆されました。実装を始める前に、まずはRISC-Vや使用する言語、本書の構成について簡単に解説します。RISC-VやVerylのことを知っているという方は、本書の構成だけ読んでいただければOKです。それでは始めましょう。</p>

<h2 class="numbox"><a id="h-1"></a>RISC-V</h2>
<p>RISC-Vはカリフォルニア大学バークレー校で開発されたRISCのISA(命令セットアーキテクチャ)です。ISAとしての歴史はまだ浅く、仕様書の初版は2011年に公開されました。それにも関わらず、RISC-Vは仕様がオープンでカスタマイズ可能であるという特徴もあって、研究目的で利用されたり既に何種類もマイコンが市販されているなど、着実に広まっていっています。</p>
<p>インターネット上には多くのRISC-Vの実装が公開されています。例として、rocket-chip(Chiselによる実装),Shakti(Bluespec SVによる実装),rsd(SystemVerilogによる実装)が挙げられます。これらを参考にして実装するのもいいと思います。</p>
<p>本書では、RISC-Vのバージョンriscv-isa-release-87edab7-2024-05-04を利用します。RISC-Vの最新の仕様は、GitHubのriscv/riscv-isa-manual (<a href="https://github.com/riscv/riscv-isa-manual/" class="link">https://github.com/riscv/riscv-isa-manual/</a>) で確認することができます。</p>
<p>RISC-Vには、基本整数命令セットとしてRV32I, RV64I, RV32E, RV64E(, RV128I)が定義されています。RVの後ろにつく数字はレジスタの長さ(XLEN)が何ビットかです。数字の後ろにつく文字がIの場合、XLENビットのレジスタが32個存在します。Eの場合はレジスタの数が16個になります。</p>
<p>基本整数命令セットには最低限の命令しか定義されていません。それ以外のかけ算や割り算, 不可分操作, CSRなどの追加の命令や機能は拡張として定義されています。CPUが何を実装しているかを示す表現にISA Stringというものがあり、例えばかけ算と割り算, 不可分操作ができるRV32IのCPUは<code class="inline-code">RV32IMA</code>と表現されます。</p>
<p>本書では、まず、<code class="inline-code">RV32I</code>のCPUを作成します。これを<code class="inline-code">RV64IMACFD_Zicond_Zicsr_Zifencei</code>に進化させることを目標に実装を進めます。</p>

<h2 class="numbox"><a id="h-2"></a>使用する言語</h2>
<p>ハードウェア記述言語とは、文字通り、ハードウェアを記述するための言語です。ハードウェアとは具体的には論理回路のことで、ハードウェア記述言語を使うと論理回路を記述, 生成することができます。これ以降、ハードウェア記述言語のことをHDL(Hardware Description Language)と書きます。</p>
<p>有名なHDLとしてはVerilog HDL, SystemVerilog, VHDLが挙げられますが、本書では、CPUの実装にVerylというHDLを使用します。VerylはSystemVerilogの構文を書きやすくしたような言語で、VerylのプログラムはSystemVerilogに変換することができます。そのため、SystemVerilogを利用できる環境でVerylを使用することができます。</p>
<p>Verylの構文や機能はSystemVerilogと似通っており、SystemVerilogが分かる人は殆ど時間をかけずにVerylを書けるようになると思います。本書はSystemVerilogを知らない人を対象にしているため、SystemVerilogを知っている必要はありません。Verylの詳細や記法については<a href="./03-veryl.html">第2章「ハードウェア記述言語 Veryl」</a>で解説します。</p>
<p>他には、シミュレーションやテストのためにC++, Pythonを利用します。プログラムがどのような意味や機能を持つかについては解説しますが、言語の仕様や書き方、ライブラリなどについては説明しません。</p>

<h2 class="numbox"><a id="h-3"></a>本書の構成</h2>
<p>本シリーズ(基本編)では、次のようにCPUを実装していきます。</p>
<ol start="1" type="1">
<li>RV32IのCPUを実装する (<a href="./04-impl-rv32i.html">第3章</a>)</li>
<li>Zicsr拡張を実装する (<a href="./04a-zicsr.html">第4章</a>)</li>
<li>RV64Iを実装する (<a href="./05-impl-rv64i.html">第6章</a>)</li>
<li>パイプライン化する (<a href="./05a-pipeline.html">第7章</a>)</li>
<li>M, A, C拡張を実装する</li>
<li>UARTの仕組みと割り込みを実装する</li>
<li>OSを実行するために必要なCSRを実装する</li>
<li>OSを実行する</li>
</ol>
<p>本書(基本編の第I部)では、上の1から4までを実装, 解説します。</p>
<p>プログラムのテストはシミュレーションと実機(FPGA)で行います。本書では、TangMega 138KとPYNQ-Z1というFPGAを利用します。ただし、実機がなくても実装を進めることができるので所有していなくても構いません。</p>

        </main>
        <nav class="page-navi">
          <a href="00-preface.html" class="page-prev">&#9664;</a>
          <a href="02-setup.html" class="page-next">&#9654;</a>
        </nav>
        <footer>
        </footer>
      </div>
    </div>
  </body>
</html>
<!-- layout.html5.erb -->
